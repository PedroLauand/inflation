<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples and features &mdash; Inflation 2.0.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced" href="advanced.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="contents.html" class="icon icon-home"> Inflation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples and features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Compatibility-problems">Compatibility problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-1:-Infeasibility-of-the-2PR-distribution-in-the-quantum-tripartite-line-scenario">Example 1: Infeasibility of the 2PR distribution in the quantum tripartite line scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Certificate-extraction">Certificate extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Feasibility-as-optimisation">Feasibility as optimisation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Scenarios-with-classical-sources">Scenarios with classical sources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-2:-The-Fritz-distribution-in-the-triangle-scenario">Example 2: The Fritz distribution in the triangle scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-3:-Full-network-nonlocality">Example 3: Full network nonlocality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Optimization-of-Bell-operators">Optimization of Bell operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-4.-Upper-bounds-on-Mermin’s-inequality">Example 4. Upper bounds on Mermin’s inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Customising-the-generating-set-for-the-semidefinite-relaxation">Customising the generating set for the semidefinite relaxation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Standard-NPA-hierarchy">Standard NPA hierarchy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-5:-Critical-visibility-of-the-PR-box-in-the-standard-Bell-scenario-with-quantum-sources">Example 5: Critical visibility of the PR box in the standard Bell scenario with quantum sources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Feasibility-with-limited-information">Feasibility with limited information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-6:-Eavesdropped-quantum-repeater">Example 6: Eavesdropped quantum repeater</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Using-certificates-of-infeasibility-to-speed-up-optimization-of-scalars">Using certificates of infeasibility to speed up optimization of scalars</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-7:-Device-independent-entanglement-certification">Example 7: Device independent entanglement certification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Non-negative-operators-as-generating-monomials">Non-negative operators as generating monomials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-8:-Critical-visibility-of-the-W-distribution-with-the-hierarchy-of-non-negative-monomials">Example 8: Critical visibility of the W distribution with the hierarchy of non-negative monomials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Linearized-polynomial-identification-constraints">Linearized polynomial identification constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-9:-Critical-visibility-of-the-W-distribution-with-LPI-constraints">Example 9: Critical visibility of the W distribution with LPI constraints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Non-network-scenarios">Non-network scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-10:-Feasibility-and-optimization-in-the-instrumental-scenario">Example 10: Feasibility and optimization in the instrumental scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-11:-Scenarios-with-multiple-layers-of-latent-nodes">Example 11: Scenarios with multiple layers of latent nodes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Feasibility-based-on-distribution-supports">Feasibility based on distribution supports</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-12:-Impossible-distributions-in-the-quantum-instrumental-scenario">Example 12: Impossible distributions in the quantum instrumental scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-13:-Hardy’s-paradox">Example 13: Hardy’s paradox</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Estimation-of-causal-strengths">Estimation of causal strengths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-14:-Estimation-of-the-average-causal-strength-in-the-triangle-scenario-with-signaling">Example 14: Estimation of the average causal strength in the triangle scenario with signaling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">Inflation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="contents.html" class="icon icon-home"></a> &raquo;</li>
      <li>Examples and features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Examples-and-features">
<h1>Examples and features<a class="headerlink" href="#Examples-and-features" title="Permalink to this heading"></a></h1>
<p>In this section we will showcase the different features of Inflation progressively through a series of examples.</p>
<section id="Compatibility-problems">
<h2>Compatibility problems<a class="headerlink" href="#Compatibility-problems" title="Permalink to this heading"></a></h2>
<p>One of the basic functionalities of Inflation is addressing compatibility problems of probability distributions with causal models. These were illustrated in the <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/tutorial.html">Tutorial</a> section. Here we revisit briefly the examples, and complement them with further functionality, such as extraction of infeasibility certificates and rephrasing feasibility problems in optimization ones.</p>
<section id="Example-1:-Infeasibility-of-the-2PR-distribution-in-the-quantum-tripartite-line-scenario">
<h3>Example 1: Infeasibility of the 2PR distribution in the quantum tripartite line scenario<a class="headerlink" href="#Example-1:-Infeasibility-of-the-2PR-distribution-in-the-quantum-tripartite-line-scenario" title="Permalink to this heading"></a></h3>
<p>Let us begin by recalling the example considered in the <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/tutorial.html">Tutorial</a>, namely the compatibility of the 2PR distribution,</p>
<div class="math notranslate nohighlight">
\[P_{\text{2PR}}(a,b,c|x,y,z) := \frac{1+ (-1)^{a+b+c+xy+yz}}{8},\]</div>
<p>with the tripartite line scenario, described by the following DAG</p>
<center><p><img alt="bilocal" class="no-scaled-link" src="_images/bilocal.png" style="width: 450px;" /></p>
</center><p>where the latent nodes represent sources of quantum systems. The program that determined the solution to this problem is the following</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">tri_line</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
                            <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                            <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                            <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">tri_line</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa2&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P_2PR</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">vis</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">))</span> <span class="o">/</span> <span class="mi">8</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P_2PR</span><span class="p">())</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">status</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;infeasible&#39;
</pre></div></div>
</div>
<p>The problem status is reported as infeasible. This means that in the quantum inflation where there are two copies of each source (because we defined <code class="docutils literal notranslate"><span class="pre">inflation_level_per_source=(2,</span> <span class="pre">2)</span></code>), no quantum states and measurements exist that can satisfy all the constraints implied by the scenario and the distribution. As a consequence of this, the 2PR distribution is proved to be incompatible with the quantum tripartite line scenario.</p>
</section>
<section id="Certificate-extraction">
<h3>Certificate extraction<a class="headerlink" href="#Certificate-extraction" title="Permalink to this heading"></a></h3>
<p>Since the feasibility problem is a semidefinite program, we can use <a class="reference external" href="https://en.wikipedia.org/wiki/Farkas%27_lemma">Farkas’ lemma</a> to find a certificate that witnesses the incompatibility. Inflation takes care of this automatically when solving the problem. The certificate will take the form of a polynomial inequality in the probabilities, <span class="math notranslate nohighlight">\(\text{Poly}(p(a,b,c|x,y,z)) &lt; 0\)</span> . This means that any other distribution <span class="math notranslate nohighlight">\(p'(a,b,c|x,y,z)\)</span> that also satisfies the inequality,
<span class="math notranslate nohighlight">\(\text{Poly}(p'(a,b,c|x,y,z)) &lt; 0\)</span>, is guaranteed also to lead to an infeasible SDP, and thus to a proof that it cannot be generated in the quantum triangle scenario.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cert</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">certificate_as_probs</span><span class="p">()</span>
<span class="n">cert</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$\displaystyle - 72.128 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] P[A_{0}{=}0] - 122.795 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] P[A_{1}{=}0] - 62.664 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] P[B_{0}{=}0] - 48.433 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] P[B_{1}{=}0] - 72.128 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] P[C_{0}{=}0] - 122.795 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] P[C_{1}{=}0] - 399.273 P[A_{0}{=}0,B_{0}{=}0,C_{0}{=}0] - 115.438 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] P[A_{0}{=}0] - 101.015 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] P[A_{1}{=}0] - 76.54 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] P[B_{0}{=}0] - 57.948 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] P[B_{1}{=}0] - 101.015 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] P[C_{0}{=}0] - 115.438 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] P[C_{1}{=}0] - 489.78 P[A_{0}{=}0,B_{0}{=}0,C_{1}{=}0] - 1.991 P[A_{0}{=}0,B_{0}{=}0]^{2} + 19.987 P[A_{0}{=}0,B_{0}{=}0] P[A_{0}{=}0,B_{1}{=}0] + 17.102 P[A_{0}{=}0,B_{0}{=}0] P[A_{0}{=}0] P[C_{0}{=}0] + 2.879 P[A_{0}{=}0,B_{0}{=}0] P[A_{0}{=}0] P[C_{1}{=}0] + 45.844 P[A_{0}{=}0,B_{0}{=}0] P[A_{0}{=}0] - 17.302 P[A_{0}{=}0,B_{0}{=}0] P[A_{1}{=}0,B_{0}{=}0] + 27.873 P[A_{0}{=}0,B_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0] + 16.284 P[A_{0}{=}0,B_{0}{=}0] P[A_{1}{=}0] P[C_{0}{=}0] + 1.92 P[A_{0}{=}0,B_{0}{=}0] P[A_{1}{=}0] P[C_{1}{=}0] + 25.729 P[A_{0}{=}0,B_{0}{=}0] P[A_{1}{=}0] + 79.686 P[A_{0}{=}0,B_{0}{=}0] P[B_{0}{=}0,C_{0}{=}0] + 56.414 P[A_{0}{=}0,B_{0}{=}0] P[B_{0}{=}0,C_{1}{=}0] + 57.177 P[A_{0}{=}0,B_{0}{=}0] P[B_{0}{=}0] + 34.486 P[A_{0}{=}0,B_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] + 26.113 P[A_{0}{=}0,B_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 39.189 P[A_{0}{=}0,B_{0}{=}0] P[B_{1}{=}0] + 174.388 P[A_{0}{=}0,B_{0}{=}0] P[C_{0}{=}0] + 105.106 P[A_{0}{=}0,B_{0}{=}0] P[C_{1}{=}0] + 243.723 P[A_{0}{=}0,B_{0}{=}0] - 124.902 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] P[A_{0}{=}0] - 127.575 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] P[A_{1}{=}0] - 74.619 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] P[B_{0}{=}0] - 59.671 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] P[B_{1}{=}0] - 124.902 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] P[C_{0}{=}0] - 127.575 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] P[C_{1}{=}0] - 460.546 P[A_{0}{=}0,B_{1}{=}0,C_{0}{=}0] + 141.332 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] P[A_{0}{=}0] + 175.5 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] P[A_{1}{=}0] + 100.036 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] P[B_{0}{=}0] + 89.656 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] P[B_{1}{=}0] + 175.5 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] P[C_{0}{=}0] + 141.332 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] P[C_{1}{=}0] + 469.539 P[A_{0}{=}0,B_{1}{=}0,C_{1}{=}0] - 4.577 P[A_{0}{=}0,B_{1}{=}0]^{2} + 15.798 P[A_{0}{=}0,B_{1}{=}0] P[A_{0}{=}0] P[C_{0}{=}0] - 18.432 P[A_{0}{=}0,B_{1}{=}0] P[A_{0}{=}0] P[C_{1}{=}0] - 34.285 P[A_{0}{=}0,B_{1}{=}0] P[A_{0}{=}0] + 27.873 P[A_{0}{=}0,B_{1}{=}0] P[A_{1}{=}0,B_{0}{=}0] + 27.521 P[A_{0}{=}0,B_{1}{=}0] P[A_{1}{=}0,B_{1}{=}0] + 32.006 P[A_{0}{=}0,B_{1}{=}0] P[A_{1}{=}0] P[C_{0}{=}0] - 19.962 P[A_{0}{=}0,B_{1}{=}0] P[A_{1}{=}0] P[C_{1}{=}0] - 21.893 P[A_{0}{=}0,B_{1}{=}0] P[A_{1}{=}0] + 34.486 P[A_{0}{=}0,B_{1}{=}0] P[B_{0}{=}0,C_{0}{=}0] + 26.113 P[A_{0}{=}0,B_{1}{=}0] P[B_{0}{=}0,C_{1}{=}0] - 25.021 P[A_{0}{=}0,B_{1}{=}0] P[B_{0}{=}0] + 51.808 P[A_{0}{=}0,B_{1}{=}0] P[B_{1}{=}0,C_{0}{=}0] - 27.396 P[A_{0}{=}0,B_{1}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 6.083 P[A_{0}{=}0,B_{1}{=}0] P[B_{1}{=}0] + 38.879 P[A_{0}{=}0,B_{1}{=}0] P[C_{0}{=}0] - 40.34 P[A_{0}{=}0,B_{1}{=}0] P[C_{1}{=}0] + 68.976 P[A_{0}{=}0,B_{1}{=}0] + 29.07 P[A_{0}{=}0]^{2} P[C_{0}{=}0]^{2} - 4.077 P[A_{0}{=}0]^{2} P[C_{0}{=}0] P[C_{1}{=}0] + 30.326 P[A_{0}{=}0]^{2} P[C_{0}{=}0] + 4.016 P[A_{0}{=}0]^{2} P[C_{1}{=}0]^{2} - 49.05 P[A_{0}{=}0]^{2} P[C_{1}{=}0] - 1.0 P[A_{0}{=}0]^{2} - 101.015 P[A_{0}{=}0] P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] - 122.795 P[A_{0}{=}0] P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] + 1.92 P[A_{0}{=}0] P[A_{1}{=}0,B_{0}{=}0] P[C_{0}{=}0] + 16.284 P[A_{0}{=}0] P[A_{1}{=}0,B_{0}{=}0] P[C_{1}{=}0] + 25.729 P[A_{0}{=}0] P[A_{1}{=}0,B_{0}{=}0] + 175.5 P[A_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] - 127.575 P[A_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] - 19.962 P[A_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0] P[C_{0}{=}0] + 32.006 P[A_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0] P[C_{1}{=}0] - 21.893 P[A_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0] - 4.077 P[A_{0}{=}0] P[A_{1}{=}0] P[C_{0}{=}0]^{2} + 47.242 P[A_{0}{=}0] P[A_{1}{=}0] P[C_{0}{=}0] P[C_{1}{=}0] + 65.321 P[A_{0}{=}0] P[A_{1}{=}0] P[C_{0}{=}0] - 4.077 P[A_{0}{=}0] P[A_{1}{=}0] P[C_{1}{=}0]^{2} + 65.321 P[A_{0}{=}0] P[A_{1}{=}0] P[C_{1}{=}0] - 8.057 P[A_{0}{=}0] P[A_{1}{=}0] + 17.102 P[A_{0}{=}0] P[B_{0}{=}0,C_{0}{=}0] P[C_{0}{=}0] + 16.284 P[A_{0}{=}0] P[B_{0}{=}0,C_{0}{=}0] P[C_{1}{=}0] + 174.388 P[A_{0}{=}0] P[B_{0}{=}0,C_{0}{=}0] + 1.92 P[A_{0}{=}0] P[B_{0}{=}0,C_{1}{=}0] P[C_{0}{=}0] + 2.879 P[A_{0}{=}0] P[B_{0}{=}0,C_{1}{=}0] P[C_{1}{=}0] + 105.106 P[A_{0}{=}0] P[B_{0}{=}0,C_{1}{=}0] - 10.811 P[A_{0}{=}0] P[B_{0}{=}0] P[C_{0}{=}0] - 56.669 P[A_{0}{=}0] P[B_{0}{=}0] P[C_{1}{=}0] - 9.708 P[A_{0}{=}0] P[B_{0}{=}0] + 15.798 P[A_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] P[C_{0}{=}0] + 32.006 P[A_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] P[C_{1}{=}0] + 38.879 P[A_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] - 19.962 P[A_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] P[C_{0}{=}0] - 18.432 P[A_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] P[C_{1}{=}0] - 40.34 P[A_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] - 8.442 P[A_{0}{=}0] P[B_{1}{=}0] P[C_{0}{=}0] - 6.86 P[A_{0}{=}0] P[B_{1}{=}0] P[C_{1}{=}0] + 25.047 P[A_{0}{=}0] P[B_{1}{=}0] + 30.326 P[A_{0}{=}0] P[C_{0}{=}0]^{2} + 65.321 P[A_{0}{=}0] P[C_{0}{=}0] P[C_{1}{=}0] + 332.923 P[A_{0}{=}0] P[C_{0}{=}0] - 49.05 P[A_{0}{=}0] P[C_{1}{=}0]^{2} + 107.056 P[A_{0}{=}0] P[C_{1}{=}0] + 58.021 P[A_{0}{=}0] - 115.438 P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] P[A_{1}{=}0] - 76.54 P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] P[B_{0}{=}0] - 57.948 P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] P[B_{1}{=}0] - 115.438 P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] P[C_{0}{=}0] - 101.015 P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] P[C_{1}{=}0] - 489.78 P[A_{1}{=}0,B_{0}{=}0,C_{0}{=}0] - 72.128 P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] P[A_{1}{=}0] - 62.664 P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] P[B_{0}{=}0] - 48.433 P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] P[B_{1}{=}0] - 122.795 P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] P[C_{0}{=}0] - 72.128 P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] P[C_{1}{=}0] - 399.273 P[A_{1}{=}0,B_{0}{=}0,C_{1}{=}0] - 1.991 P[A_{1}{=}0,B_{0}{=}0]^{2} + 19.987 P[A_{1}{=}0,B_{0}{=}0] P[A_{1}{=}0,B_{1}{=}0] + 2.879 P[A_{1}{=}0,B_{0}{=}0] P[A_{1}{=}0] P[C_{0}{=}0] + 17.102 P[A_{1}{=}0,B_{0}{=}0] P[A_{1}{=}0] P[C_{1}{=}0] + 45.844 P[A_{1}{=}0,B_{0}{=}0] P[A_{1}{=}0] + 56.414 P[A_{1}{=}0,B_{0}{=}0] P[B_{0}{=}0,C_{0}{=}0] + 79.686 P[A_{1}{=}0,B_{0}{=}0] P[B_{0}{=}0,C_{1}{=}0] + 57.177 P[A_{1}{=}0,B_{0}{=}0] P[B_{0}{=}0] + 26.113 P[A_{1}{=}0,B_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] + 34.486 P[A_{1}{=}0,B_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 39.189 P[A_{1}{=}0,B_{0}{=}0] P[B_{1}{=}0] + 105.106 P[A_{1}{=}0,B_{0}{=}0] P[C_{0}{=}0] + 174.388 P[A_{1}{=}0,B_{0}{=}0] P[C_{1}{=}0] + 243.723 P[A_{1}{=}0,B_{0}{=}0] + 141.332 P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] P[A_{1}{=}0] + 100.036 P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] P[B_{0}{=}0] + 89.656 P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] P[B_{1}{=}0] + 141.332 P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] P[C_{0}{=}0] + 175.5 P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] P[C_{1}{=}0] + 469.539 P[A_{1}{=}0,B_{1}{=}0,C_{0}{=}0] - 124.902 P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] P[A_{1}{=}0] - 74.619 P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] P[B_{0}{=}0] - 59.671 P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] P[B_{1}{=}0] - 127.575 P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] P[C_{0}{=}0] - 124.902 P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] P[C_{1}{=}0] - 460.546 P[A_{1}{=}0,B_{1}{=}0,C_{1}{=}0] - 4.577 P[A_{1}{=}0,B_{1}{=}0]^{2} - 18.432 P[A_{1}{=}0,B_{1}{=}0] P[A_{1}{=}0] P[C_{0}{=}0] + 15.798 P[A_{1}{=}0,B_{1}{=}0] P[A_{1}{=}0] P[C_{1}{=}0] - 34.285 P[A_{1}{=}0,B_{1}{=}0] P[A_{1}{=}0] + 26.113 P[A_{1}{=}0,B_{1}{=}0] P[B_{0}{=}0,C_{0}{=}0] + 34.486 P[A_{1}{=}0,B_{1}{=}0] P[B_{0}{=}0,C_{1}{=}0] - 25.021 P[A_{1}{=}0,B_{1}{=}0] P[B_{0}{=}0] - 27.396 P[A_{1}{=}0,B_{1}{=}0] P[B_{1}{=}0,C_{0}{=}0] + 51.808 P[A_{1}{=}0,B_{1}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 6.083 P[A_{1}{=}0,B_{1}{=}0] P[B_{1}{=}0] - 40.34 P[A_{1}{=}0,B_{1}{=}0] P[C_{0}{=}0] + 38.879 P[A_{1}{=}0,B_{1}{=}0] P[C_{1}{=}0] + 68.976 P[A_{1}{=}0,B_{1}{=}0] + 4.016 P[A_{1}{=}0]^{2} P[C_{0}{=}0]^{2} - 4.077 P[A_{1}{=}0]^{2} P[C_{0}{=}0] P[C_{1}{=}0] - 49.05 P[A_{1}{=}0]^{2} P[C_{0}{=}0] + 29.07 P[A_{1}{=}0]^{2} P[C_{1}{=}0]^{2} + 30.326 P[A_{1}{=}0]^{2} P[C_{1}{=}0] - 1.0 P[A_{1}{=}0]^{2} + 2.879 P[A_{1}{=}0] P[B_{0}{=}0,C_{0}{=}0] P[C_{0}{=}0] + 1.92 P[A_{1}{=}0] P[B_{0}{=}0,C_{0}{=}0] P[C_{1}{=}0] + 105.106 P[A_{1}{=}0] P[B_{0}{=}0,C_{0}{=}0] + 16.284 P[A_{1}{=}0] P[B_{0}{=}0,C_{1}{=}0] P[C_{0}{=}0] + 17.102 P[A_{1}{=}0] P[B_{0}{=}0,C_{1}{=}0] P[C_{1}{=}0] + 174.388 P[A_{1}{=}0] P[B_{0}{=}0,C_{1}{=}0] - 56.669 P[A_{1}{=}0] P[B_{0}{=}0] P[C_{0}{=}0] - 10.811 P[A_{1}{=}0] P[B_{0}{=}0] P[C_{1}{=}0] - 9.708 P[A_{1}{=}0] P[B_{0}{=}0] - 18.432 P[A_{1}{=}0] P[B_{1}{=}0,C_{0}{=}0] P[C_{0}{=}0] - 19.962 P[A_{1}{=}0] P[B_{1}{=}0,C_{0}{=}0] P[C_{1}{=}0] - 40.34 P[A_{1}{=}0] P[B_{1}{=}0,C_{0}{=}0] + 32.006 P[A_{1}{=}0] P[B_{1}{=}0,C_{1}{=}0] P[C_{0}{=}0] + 15.798 P[A_{1}{=}0] P[B_{1}{=}0,C_{1}{=}0] P[C_{1}{=}0] + 38.879 P[A_{1}{=}0] P[B_{1}{=}0,C_{1}{=}0] - 6.86 P[A_{1}{=}0] P[B_{1}{=}0] P[C_{0}{=}0] - 8.442 P[A_{1}{=}0] P[B_{1}{=}0] P[C_{1}{=}0] + 25.047 P[A_{1}{=}0] P[B_{1}{=}0] - 49.05 P[A_{1}{=}0] P[C_{0}{=}0]^{2} + 65.321 P[A_{1}{=}0] P[C_{0}{=}0] P[C_{1}{=}0] + 107.056 P[A_{1}{=}0] P[C_{0}{=}0] + 30.326 P[A_{1}{=}0] P[C_{1}{=}0]^{2} + 332.923 P[A_{1}{=}0] P[C_{1}{=}0] + 58.021 P[A_{1}{=}0] - 1.991 P[B_{0}{=}0,C_{0}{=}0]^{2} - 17.302 P[B_{0}{=}0,C_{0}{=}0] P[B_{0}{=}0,C_{1}{=}0] + 57.177 P[B_{0}{=}0,C_{0}{=}0] P[B_{0}{=}0] + 19.987 P[B_{0}{=}0,C_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] + 27.873 P[B_{0}{=}0,C_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 39.189 P[B_{0}{=}0,C_{0}{=}0] P[B_{1}{=}0] + 45.844 P[B_{0}{=}0,C_{0}{=}0] P[C_{0}{=}0] + 25.729 P[B_{0}{=}0,C_{0}{=}0] P[C_{1}{=}0] + 243.723 P[B_{0}{=}0,C_{0}{=}0] - 1.991 P[B_{0}{=}0,C_{1}{=}0]^{2} + 57.177 P[B_{0}{=}0,C_{1}{=}0] P[B_{0}{=}0] + 27.873 P[B_{0}{=}0,C_{1}{=}0] P[B_{1}{=}0,C_{0}{=}0] + 19.987 P[B_{0}{=}0,C_{1}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 39.189 P[B_{0}{=}0,C_{1}{=}0] P[B_{1}{=}0] + 25.729 P[B_{0}{=}0,C_{1}{=}0] P[C_{0}{=}0] + 45.844 P[B_{0}{=}0,C_{1}{=}0] P[C_{1}{=}0] + 243.723 P[B_{0}{=}0,C_{1}{=}0] + 16.282 P[B_{0}{=}0]^{2} - 25.021 P[B_{0}{=}0] P[B_{1}{=}0,C_{0}{=}0] - 25.021 P[B_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 37.071 P[B_{0}{=}0] P[B_{1}{=}0] - 9.708 P[B_{0}{=}0] P[C_{0}{=}0] - 9.708 P[B_{0}{=}0] P[C_{1}{=}0] + 95.367 P[B_{0}{=}0] - 4.577 P[B_{1}{=}0,C_{0}{=}0]^{2} + 27.521 P[B_{1}{=}0,C_{0}{=}0] P[B_{1}{=}0,C_{1}{=}0] + 6.083 P[B_{1}{=}0,C_{0}{=}0] P[B_{1}{=}0] - 34.285 P[B_{1}{=}0,C_{0}{=}0] P[C_{0}{=}0] - 21.893 P[B_{1}{=}0,C_{0}{=}0] P[C_{1}{=}0] + 68.976 P[B_{1}{=}0,C_{0}{=}0] - 4.577 P[B_{1}{=}0,C_{1}{=}0]^{2} + 6.083 P[B_{1}{=}0,C_{1}{=}0] P[B_{1}{=}0] - 21.893 P[B_{1}{=}0,C_{1}{=}0] P[C_{0}{=}0] - 34.285 P[B_{1}{=}0,C_{1}{=}0] P[C_{1}{=}0] + 68.976 P[B_{1}{=}0,C_{1}{=}0] + 46.338 P[B_{1}{=}0]^{2} + 25.047 P[B_{1}{=}0] P[C_{0}{=}0] + 25.047 P[B_{1}{=}0] P[C_{1}{=}0] + 159.051 P[B_{1}{=}0] - 1.0 P[C_{0}{=}0]^{2} - 8.057 P[C_{0}{=}0] P[C_{1}{=}0] + 58.021 P[C_{0}{=}0] - 1.0 P[C_{1}{=}0]^{2} + 58.021 P[C_{1}{=}0] + 35.981$</div></div>
</div>
<p>This certificate evaluates, indeed, to a negative quantity when evaluated in the 2PR distribution, and to positive quantities in feasible distributions like the uniform one.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2PR distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sdp</span><span class="o">.</span><span class="n">evaluate_certificate</span><span class="p">(</span><span class="n">P_2PR</span><span class="p">()))</span>

<span class="c1"># Uniform distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sdp</span><span class="o">.</span><span class="n">evaluate_certificate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">P_2PR</span><span class="p">())</span> <span class="o">/</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-1.7280000000005655
769.4236250000001
</pre></div></div>
</div>
</section>
<section id="Feasibility-as-optimisation">
<h3>Feasibility as optimisation<a class="headerlink" href="#Feasibility-as-optimisation" title="Permalink to this heading"></a></h3>
<p>Feasibility problems are numerically unstable due to problems with floating-point precision. A more numerically robust approach is to convert feasibility problems to optimisation problems. Take as illustration the case of semidefinite programs. Instead of imposing that the moment matrix <span class="math notranslate nohighlight">\(\Gamma\)</span> of the SDP relaxation is positive semidefinite, which is prone to numerical instabilities, we instead solve the following problem:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
{} \max &amp; \quad \lambda \\
\text{such that}&amp; \quad \Gamma - \lambda \cdot 1 \succeq 0 \end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(1\)</span> is the identity matrix. This problem maximizes the smallest eigenvalue of <span class="math notranslate nohighlight">\(\Gamma\)</span>, which is negative when <span class="math notranslate nohighlight">\(\Gamma\)</span> cannot be made positive-semidefinite (i.e., when calling <code class="docutils literal notranslate"><span class="pre">status</span></code> would return <code class="docutils literal notranslate"><span class="pre">'infeasible'</span></code>), and positive otherwise. In the case of linear programs, instead for asking whether a probability distribution compatible with the given inflation exists, we instead solve:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
{} \max &amp; \quad \lambda \\
\text{such that}&amp; \quad p_I \geq \lambda \end{array}\end{split}\]</div>
<p>This is, we seek to find a probability distribution by searching for a collection of non-negative numbers that satisfy all conditions implied by the problem. If the optimal value to the problem above is negative, it means that no such collection exists, and thus the original distribution cannot be generated in the given causal structure.</p>
<p>This transformation is produced in Inflation simply by setting the flag <code class="docutils literal notranslate"><span class="pre">feas_as_optim</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> in the <code class="docutils literal notranslate"><span class="pre">Inflation(L/SD)P.solve</span></code> method. The resulting optimal <span class="math notranslate nohighlight">\(\lambda\)</span> is stored in <code class="docutils literal notranslate"><span class="pre">Inflation(L/SD)P.objective_value</span></code>. This can be used, for example, for writing optimization problems on top of inflation problems. Let us illustrate this with the computation of the critical visibility of the 2PR distribution in the quantum tripartite line scenario:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">bisect</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">tri_line</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
                            <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                            <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                            <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">tri_line</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa2&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P_2PR</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">vis</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">))</span> <span class="o">/</span> <span class="mi">8</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">min_eigenvalue</span><span class="p">(</span><span class="n">vis</span><span class="p">):</span>
    <span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P_2PR</span><span class="p">(</span><span class="n">vis</span><span class="p">))</span>
    <span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">feas_as_optim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Visibility = </span><span class="si">{</span><span class="n">vis</span><span class="si">:</span><span class="s2">&lt;6.4g</span><span class="si">}</span><span class="s2">   &quot;</span> <span class="o">+</span>
          <span class="s2">&quot;Maximum smallest eigenvalue: &quot;</span> <span class="o">+</span>
          <span class="s2">&quot;</span><span class="si">{:10.4g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sdp</span><span class="o">.</span><span class="n">objective_value</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">sdp</span><span class="o">.</span><span class="n">objective_value</span>

<span class="n">bisect</span><span class="p">(</span><span class="n">min_eigenvalue</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Visibility = 0        Maximum smallest eigenvalue:    0.01208
Visibility = 1        Maximum smallest eigenvalue:     -0.112
Visibility = 0.5      Maximum smallest eigenvalue:  5.531e-09
Visibility = 0.75     Maximum smallest eigenvalue:   -0.04709
Visibility = 0.625    Maximum smallest eigenvalue:   -0.02075
Visibility = 0.5625   Maximum smallest eigenvalue:  -0.009571
Visibility = 0.5312   Maximum smallest eigenvalue:  -0.004592
Visibility = 0.5156   Maximum smallest eigenvalue:   -0.00226
Visibility = 0.5078   Maximum smallest eigenvalue:  -0.001123
Visibility = 0.5039   Maximum smallest eigenvalue: -0.0005598
Visibility = 0.502    Maximum smallest eigenvalue: -0.0002794
Visibility = 0.501    Maximum smallest eigenvalue: -0.0001396
Visibility = 0.5005   Maximum smallest eigenvalue: -6.978e-05
Visibility = 0.5002   Maximum smallest eigenvalue: -3.488e-05
Visibility = 0.5001   Maximum smallest eigenvalue: -1.744e-05
Visibility = 0.5001   Maximum smallest eigenvalue: -8.715e-06
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.50006103515625
</pre></div></div>
</div>
<p>We recover a critical visibility that is consistent with the known critical visibility of the 2PR distribution in the quantum tripartite-line scenario, namely <span class="math notranslate nohighlight">\(v&gt;\frac{1}{2}\)</span> [<a class="reference external" href="https://arxiv.org/abs/1112.4502">1</a>]. Higher inflations or higher levels in the NPA hierarchy are expected to get closer to the correct value, <span class="math notranslate nohighlight">\(v=\frac{1}{2}\)</span>, and potentially reaching it, as the hierarchy increases.</p>
<p>Note that in this example we have created our own bisection function. In the following examples, we will use an <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/optimization.html#inflation.optimization_utils.max_within_feasible">in-built one</a>.</p>
</section>
</section>
<section id="Scenarios-with-classical-sources">
<h2>Scenarios with classical sources<a class="headerlink" href="#Scenarios-with-classical-sources" title="Permalink to this heading"></a></h2>
<p>In inflation, both the one based in linear programming and the one based in semidefinite programming, on of the primary applications is to optimize over relaxations of the sets of distributions compatible with DAGs where some (or all) sources distribute classical shared randomness. While this is direct in the methods based in linear programming, in those based on semidefinite programming this works by imposing the constraint that the operators that act on classical systems and different copies
of the remaining systems commute. The effect of these constraints is that previously different variables become equal. For example, <span class="math notranslate nohighlight">\(\langle A_{x} A_{x'} \rangle \neq \langle A_{x'} A_{x} \rangle\)</span> in general in quantum mechanics, but if we assume that the operators act on classical systems, then they become equal. In the semidefinite-programming technique, when all sources in the scenario are classical, one obtains hierarchies analogous to that of
[<a class="reference external" href="https://arxiv.org/abs/1612.08551">2</a>], which in the case of inflation are semidefinite relaxations of the linear programs that are used in the original inflation technique [<a class="reference external" href="https://www.arxiv.org/abs/1609.00672">3</a>].</p>
<p>If there are classical sources in the scenario, these can be specified at the level of the <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code> using the argument <code class="docutils literal notranslate"><span class="pre">classical_sources</span></code>. In the following we will see two examples, that deal with classical sources in <code class="docutils literal notranslate"><span class="pre">InflationLP</span></code> and <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code>.</p>
<section id="Example-2:-The-Fritz-distribution-in-the-triangle-scenario">
<h3>Example 2: The Fritz distribution in the triangle scenario<a class="headerlink" href="#Example-2:-The-Fritz-distribution-in-the-triangle-scenario" title="Permalink to this heading"></a></h3>
<p>One of the earliest examples of correlations without local models in the triangle scenario (where three bipartite sources distribute systems to three different parties arranged in a triangle, see also <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/examples.html#Example-3.-Upper-bounds-on-Mermin%E2%80%99s-inequality">Example 4</a>) is due to Fritz [<a class="reference external" href="https://www.arxiv.org/abs/1206.5115">4</a>]. This example takes the distribution underlying a bipartite Bell test and embeds it in a tripartite
distribution with no inputs and four outcomes per party. Importantly, since it comes from a setup with a single quantum source, Fritz’s distribution can be realized only when one specific source is quantum, and the remaining two can be classical. Indeed, let us first see that setting two of the sources to be classical, inflation cannot detect Fritz’s distribution as incompatible with it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">Fritz</span><span class="p">():</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]:</span>
        <span class="n">p</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">32</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]:</span>
        <span class="n">p</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">32</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;rho_AC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
                            <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                            <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                            <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                            <span class="n">classical_sources</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rho_BC&quot;</span><span class="p">,</span> <span class="s2">&quot;rho_AC&quot;</span><span class="p">]</span>
                            <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="c1"># We use a custom generating set of columns. See Example 3 for details</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">,</span> <span class="n">max_monomial_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">Fritz</span><span class="p">())</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sdp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
feasible
</pre></div></div>
</div>
<p>However, as soon as the relevant source (for the form of the distribution written, <code class="docutils literal notranslate"><span class="pre">rho_AB</span></code>) is restricted to be classical, the inflation detects the distribution as incompatible.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                                 <span class="s2">&quot;rho_AC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
                            <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                            <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                            <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                            <span class="n">classical_sources</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">]</span>
                            <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;npa2&quot;</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">Fritz</span><span class="p">())</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sdp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
infeasible
</pre></div></div>
</div>
</section>
<section id="Example-3:-Full-network-nonlocality">
<h3>Example 3: Full network nonlocality<a class="headerlink" href="#Example-3:-Full-network-nonlocality" title="Permalink to this heading"></a></h3>
<p>Full network nonlocality [<a class="reference external" href="https://arxiv.org/abs/2105.09325">5</a>] is a proposal for genuinely nonclassical correlations in networks. Namely, distributions are fully network nonlocal if and only if they can not be produced if there is any classical source in the network. Notably, no restrictions are put on the remaining sources in the network, so in general they are described by some non-signaling theory. Therefore, models for non-fully network nonlocal correlations can be modeled with the
linear-programming version of inflation. In order to illustrate this, let us recover one of the results in [<a class="reference external" href="https://arxiv.org/abs/2105.09325">5</a>], namely, that the family of probability distributions that give the following correlators</p>
<div class="math notranslate nohighlight">
\[\left\langle A_x\right\rangle = \left\langle B^y\right\rangle = \left\langle C_z\right\rangle = \left\langle A_x C_z\right\rangle = 0\]</div>
<div class="math notranslate nohighlight">
\[\left\langle A_x B^y \right\rangle = -\frac12\cos\theta\delta_{x,y}, \qquad \left\langle B^y C_z \right\rangle = \frac12\cos\theta\delta_{y,z}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left\langle A_x B^y C_z \right\rangle = \begin{cases} -\frac12 (1+\sin\theta) &amp; xyz\in\{123,231,312\} \\ -\frac12 (1-\sin\theta) &amp; xyz\in\{132,213,321\} \end{cases}\end{split}\]</div>
<p>is fully network nonlocal for any <span class="math notranslate nohighlight">\(\theta\)</span> except for <span class="math notranslate nohighlight">\(\theta=0\)</span> and <span class="math notranslate nohighlight">\(\theta=\frac{\pi}{2}\)</span>. This example also requires the use of the <a class="reference external" href="https://qutip.org/">QuTiP</a> Python package to generate the probability distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationLP</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span> <span class="k">as</span> <span class="n">π</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">prob</span><span class="p">(</span><span class="n">θ</span><span class="p">):</span>
    <span class="n">ψminus</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">ket2dm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">singlet_state</span><span class="p">())</span>
    <span class="n">ψminus</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
    <span class="n">id2</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

    <span class="n">ρ</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">ψminus</span><span class="p">,</span> <span class="n">ψminus</span><span class="p">])</span>
    <span class="n">ρ</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="n">qt</span><span class="o">.</span><span class="n">sigmax</span><span class="p">(),</span> <span class="n">qt</span><span class="o">.</span><span class="n">sigmay</span><span class="p">(),</span> <span class="n">qt</span><span class="o">.</span><span class="n">sigmaz</span><span class="p">()]</span>
    <span class="n">ηs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
    <span class="n">ϕs</span> <span class="o">=</span> <span class="p">[</span><span class="n">π</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">π</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">π</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">π</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">plusm</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">minusm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">ejm</span>    <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">B</span>      <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">plusm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">ηs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">ϕs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">ηs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">ϕs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">minusm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">ηs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">ϕs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                     <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">ηs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">ϕs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">ejm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>    <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">((</span>
        <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">θ</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">plusm</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">minusm</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="o">+</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">θ</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">minusm</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">plusm</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="p">))</span>
        <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">ket2dm</span><span class="p">(</span><span class="n">ejm</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ρ</span><span class="o">.</span><span class="n">overlap</span><span class="p">(</span>
                       <span class="n">qt</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">id2</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">id2</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">c</span><span class="o">*</span><span class="n">C</span><span class="p">[</span><span class="n">z</span><span class="p">]]))</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="c1"># Define the InflationProblem</span>
<span class="n">bilocality</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;l1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                                   <span class="s1">&#39;l2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
                              <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                              <span class="n">settings_per_party</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                              <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                              <span class="n">classical_sources</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;l1&quot;</span><span class="p">])</span>

<span class="c1"># Define the linear program</span>
<span class="n">inflationLP</span> <span class="o">=</span> <span class="n">InflationLP</span><span class="p">(</span><span class="n">bilocality</span><span class="p">)</span>

<span class="k">for</span> <span class="n">θ</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">π</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">π</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">inflationLP</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">prob</span><span class="p">(</span><span class="n">θ</span><span class="p">))</span>
    <span class="n">inflationLP</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The distribution for θ=</span><span class="si">{</span><span class="n">θ</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">inflationLP</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distribution for θ=0 is optimal
The distribution for θ=0.3803811198654002 is dual_infeas_cer
The distribution for θ=1.5707963267948966 is optimal
</pre></div></div>
</div>
</section>
</section>
<section id="Optimization-of-Bell-operators">
<h2>Optimization of Bell operators<a class="headerlink" href="#Optimization-of-Bell-operators" title="Permalink to this heading"></a></h2>
<p>One can use inflation techniques to not only run causal compatibility problems, but also to optimize over the generated relaxation, and therefore get upper bounds on the values of various Bell operators.</p>
<section id="Example-4.-Upper-bounds-on-Mermin’s-inequality">
<h3>Example 4. Upper bounds on Mermin’s inequality<a class="headerlink" href="#Example-4.-Upper-bounds-on-Mermin’s-inequality" title="Permalink to this heading"></a></h3>
<p>Let us consider Mermin’s inequality, written in the correlator form as follows:</p>
<div class="math notranslate nohighlight">
\[\text{Mermin} = \langle A_1 B_0 C_0 \rangle +  \langle A_0 B_1 C_0 \rangle +  \langle A_0 B_0 C_1 \rangle -  \langle A_1 B_1 C_1 \rangle\]</div>
<p>where correlators are defined as</p>
<div class="math notranslate nohighlight">
\[\left\langle A_{x} B_{y} C_{z}\right\rangle =\sum_{a, b, c \in \{0,1\}} (-1)^{a+b+c} \, p_{ABC}(abc|xyz).\]</div>
<p>It is known that the algebraic maximum of 4 is achieved in the tripartite scenario when using genuinely tripartite entangled quantum states. However, this is not the case [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">5</a>] when restricting to states that can be generated in the following DAG, called the quantum triangle scenario:</p>
<center><p><img alt="triangle" class="no-scaled-link" src="_images/triangle.png" style="width: 300px;" /></p>
</center><p>Let us find this result with Inflation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span>
               <span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_AC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
               <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
               <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
               <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa2&quot;</span><span class="p">)</span>

<span class="n">mmnts</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">measurements</span>
<span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mmnts</span><span class="p">[</span><span class="n">party</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">setting</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">party</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">A1</span><span class="o">*</span><span class="n">B0</span><span class="o">*</span><span class="n">C0</span> <span class="o">+</span> <span class="n">A0</span><span class="o">*</span><span class="n">B1</span><span class="o">*</span><span class="n">C0</span> <span class="o">+</span> <span class="n">A0</span><span class="o">*</span><span class="n">B0</span><span class="o">*</span><span class="n">C1</span> <span class="o">-</span> <span class="n">A1</span><span class="o">*</span><span class="n">B1</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">objective_value</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.999999981240686
</pre></div></div>
</div>
<p>We get a value that is within numerical precision the algebraic maximum of 4. To improve on this result, we will need to do a tighter SDP relaxation.</p>
</section>
<section id="Customising-the-generating-set-for-the-semidefinite-relaxation">
<h3>Customising the generating set for the semidefinite relaxation<a class="headerlink" href="#Customising-the-generating-set-for-the-semidefinite-relaxation" title="Permalink to this heading"></a></h3>
<p>To get a tighter SDP relaxation, we will add more monomials to the generating set. Namely, we will use (as indicated in [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">6</a>]) the union of the monomials corresponding to NPA level 2 and local level 1.</p>
<p>In order to do so, we use the built-in method <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/inflationsdp.html#inflation.InflationSDP.build_columns">InflationSDP.build_columns</a>, which admits specifying levels in popular hierarchies (such as NPA and local levels) using a string-based notation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span>
               <span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_AC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
               <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
               <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
               <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="p">)</span>
<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>

<span class="n">npa2</span>   <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;npa2&quot;</span><span class="p">,</span> <span class="n">symbolic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">local1</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">,</span> <span class="n">symbolic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">npa2_union_local1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">npa2</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">local1</span><span class="p">))</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">npa2_union_local1</span><span class="p">))</span>

<span class="n">mmnts</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">measurements</span>
<span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">mmnts</span><span class="p">[</span><span class="n">party</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">setting</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">party</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">A1</span><span class="o">*</span><span class="n">B0</span><span class="o">*</span><span class="n">C0</span> <span class="o">+</span> <span class="n">A0</span><span class="o">*</span><span class="n">B1</span><span class="o">*</span><span class="n">C0</span> <span class="o">+</span> <span class="n">A0</span><span class="o">*</span><span class="n">B0</span><span class="o">*</span><span class="n">C1</span> <span class="o">-</span> <span class="n">A1</span><span class="o">*</span><span class="n">B1</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">objective_value</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.085044522914157
</pre></div></div>
</div>
<p>After running the above, we can certify then that the Mermin inequality cannot have a value larger than <span class="math notranslate nohighlight">\(3.085\)</span> for the quantum triangle causal scenario, recovering the result in [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">6</a>].</p>
</section>
</section>
<section id="Standard-NPA-hierarchy">
<h2>Standard NPA hierarchy<a class="headerlink" href="#Standard-NPA-hierarchy" title="Permalink to this heading"></a></h2>
<p>If the DAG corresponds to a single global shared source scenario, then doing an inflation does not grant any advantage. In this case, the semidefinite programs are those corresponding to the standard Navascués-Pironio-Acín hierarchy [<a class="reference external" href="https://arxiv.org/abs/0803.4290">7</a>].</p>
<section id="Example-5:-Critical-visibility-of-the-PR-box-in-the-standard-Bell-scenario-with-quantum-sources">
<h3>Example 5: Critical visibility of the PR box in the standard Bell scenario with quantum sources<a class="headerlink" href="#Example-5:-Critical-visibility-of-the-PR-box-in-the-standard-Bell-scenario-with-quantum-sources" title="Permalink to this heading"></a></h3>
<p>Let us recover the critical visibility of <span class="math notranslate nohighlight">\(v_{\text{crit}}=\frac{1}{\sqrt{2}}\)</span> for a Popescu-Rohrlich box [<a class="reference external" href="https://arxiv.org/abs/quant-ph/9508009">8</a>]. We will take this chance to use the <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/optimization.html#inflation.optimization_utils.max_within_feasible">in-built function</a> for optimizing scalar quantities under (relaxations of) the set of feasible distributions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">max_within_feasible</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">bellscenario</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]},</span>
                                <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">bellscenario</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa1&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P_PRbox</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">vis</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vis</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P_PRbox</span><span class="p">(</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">max_within_feasible</span><span class="p">(</span><span class="n">sdp</span><span class="p">,</span>
                        <span class="n">sdp</span><span class="o">.</span><span class="n">known_moments</span><span class="p">,</span>
                        <span class="s2">&quot;bisection&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical visibility:&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Certificate:</span><span class="se">\n</span><span class="si">{</span><span class="n">sdp</span><span class="o">.</span><span class="n">certificate_as_string</span><span class="p">(</span><span class="n">chop_tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Critical visibility: 0.70709228515625
Certificate:
1.0+4.828*P[A_0=0]+4.828*P[B_0=0]-4.828*P[A_0=0 B_0=0]-4.828*P[A_0=0 B_1=0]-4.828*P[A_1=0 B_0=0]+4.828*P[A_1=0 B_1=0] &lt; 0
</pre></div></div>
</div>
<p>Notice that the dual certificate that we extract is the well-known CHSH inequality tangent to the quantum set of correlations, modulo a global factor. We can see that this is indeed the case. For doing so, we write the resulting expression in correlators:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The Bell inequality is cert &gt; 0. Writing in correlators:</span>
<span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\langle &quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\rangle&quot;</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="n">prob_to_corr</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">cert</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">certificate_as_probs</span><span class="p">(</span><span class="n">chop_tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
    <span class="n">inputs</span>  <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">party</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">party</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)])</span>
    <span class="n">parties</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">party</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">party</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prob_to_corr</span><span class="p">[</span><span class="n">prob</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">parties</span> <span class="o">+</span><span class="s2">&quot;_{&quot;</span><span class="o">+</span><span class="n">inputs</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="o">+</span> <span class="n">r</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prob_to_corr</span><span class="p">[</span><span class="n">prob</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">parties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;_{&quot;</span><span class="o">+</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="o">+</span> <span class="n">r</span><span class="p">)</span>
             <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">parties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;_{&quot;</span><span class="o">+</span><span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="o">+</span> <span class="n">r</span><span class="p">)</span>
             <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">parties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_{&quot;</span><span class="o">+</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;}&quot;</span> <span class="o">+</span>
                      <span class="n">parties</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_{&quot;</span><span class="o">+</span><span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="n">r</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span>

<span class="mf">0.8285</span><span class="o">*</span><span class="n">cert</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">prob_to_corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$\displaystyle - 0.9999995 \langle A_{0}B_{0}\rangle - 0.9999995 \langle A_{0}B_{1}\rangle - 0.9999995 \langle A_{1}B_{0}\rangle + 0.9999995 \langle A_{1}B_{1}\rangle + 2.828499$</div></div>
</div>
</section>
</section>
<section id="Feasibility-with-limited-information">
<h2>Feasibility with limited information<a class="headerlink" href="#Feasibility-with-limited-information" title="Permalink to this heading"></a></h2>
<p>Sometimes, one does not have access to a complete probability distribution but only to certain marginals. In this case, one can specify only particular values for monomials in an <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code> via the use of the function <a class="reference external" href="https://ecboghiu.github.io/inflation/_build/html/inflationsdp.html#inflation.InflationSDP.set_values">InflationSDP.set_values</a>.</p>
<section id="Example-6:-Eavesdropped-quantum-repeater">
<h3>Example 6: Eavesdropped quantum repeater<a class="headerlink" href="#Example-6:-Eavesdropped-quantum-repeater" title="Permalink to this heading"></a></h3>
<p>An important example is the the analysis of cryptographic scenarios, where the honest parties may know their joint distribution but they cannot know their joint distribution together with a potential adversary. One simple such scenario is considered in [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">6</a>, Sec. VII]. This scenario considers the quantum repeater/entanglement swapping experiment from Example 1 but with a hidden adversary, Eve, which is eavesdropping the sources <span class="math notranslate nohighlight">\(\rho_{AB}\)</span> and
<span class="math notranslate nohighlight">\(\rho_{BC}\)</span> in an attempt to extract information about the secret key Alice and Charlie are trying to establish. In this scenario one would want to estimate how much information Eve can extract about the secret key. In the following, we implement this example within Inflation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationSDP</span><span class="p">,</span> <span class="n">InflationProblem</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">InfProb</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rhoABE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">],</span>
                                <span class="s2">&quot;rhoBCE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">]},</span>
                           <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                           <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                           <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                           <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">])</span>
<span class="n">InfSDP</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">InfProb</span><span class="p">)</span>
<span class="n">InfSDP</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span>
    <span class="n">InfSDP</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">,</span> <span class="n">max_monomial_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                           <span class="p">)</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">InfSDP</span><span class="o">.</span><span class="n">measurements</span>
<span class="n">A0</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">C0</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">E0</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">P_ABC</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> \
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> \
             <span class="n">vis</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">b0</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">b1</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
             <span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">P_ABC</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">InfSDP</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">A0</span><span class="o">*</span><span class="n">C0</span><span class="o">*</span><span class="n">E0</span> <span class="o">/</span> <span class="n">p0</span> <span class="o">-</span> <span class="n">E0</span><span class="p">)</span>

    <span class="n">known_values</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># 3 body terms</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                     <span class="o">*</span><span class="n">meas</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
                     <span class="o">*</span><span class="n">meas</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="n">c</span><span class="p">]]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>

    <span class="c1"># 2 body terms</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                     <span class="o">*</span><span class="n">meas</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                     <span class="o">*</span><span class="n">meas</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
                     <span class="o">*</span><span class="n">meas</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

    <span class="c1"># 1 body terms</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">a</span><span class="p">]]</span> \
            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">b</span><span class="p">]]</span> \
            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="n">b</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">known_values</span><span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">z</span><span class="p">][</span><span class="n">c</span><span class="p">]]</span> \
            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

    <span class="n">InfSDP</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">known_values</span><span class="p">)</span>
    <span class="n">InfSDP</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>  <span class="c1"># It takes a while to solve</span>
    <span class="c1"># print(vis, InfSDP.objective_value)</span>
</pre></div>
</div>
</div>
<p>After running the code above and plotting the curve:</p>
<center><p><img alt="eavesdropped repeater results" class="no-scaled-link" src="_images/repeater.png" style="width: 350px;" /></p>
</center><p>we recover the correct bounds from [<a class="reference external" href="https://www.axiv.org/abs/1909.10519">6</a>].</p>
</section>
</section>
<section id="Using-certificates-of-infeasibility-to-speed-up-optimization-of-scalars">
<h2>Using certificates of infeasibility to speed up optimization of scalars<a class="headerlink" href="#Using-certificates-of-infeasibility-to-speed-up-optimization-of-scalars" title="Permalink to this heading"></a></h2>
<p>In several examples we have used a bisection algorithm to compute critical visibilities. Bisection provides a good and general way of finding zeros of functions, taking <span class="math notranslate nohighlight">\(n=\lceil \log_2\Delta-\log_2\varepsilon\rceil\)</span> iterations to reach a solution within accuracy <span class="math notranslate nohighlight">\(\varepsilon\)</span> when the variable is constrained to lie in an interval of length <span class="math notranslate nohighlight">\(\Delta\)</span>. It turns out that this number of steps can be reduced by using the certificates of infeasibility. These certificates are surfaces
that always leave the feasible region in the half-space that takes positive values. Typically, choosing as next candidate the value of the parameter that lies within the surface <span class="math notranslate nohighlight">\(\text{cert}=0\)</span> takes one closer to the actual solution than taking the increasingly smaller steps that are taken in bisection, saving in SDP evaluations. It is possible to use the certificates of infeasibility when using <code class="docutils literal notranslate"><span class="pre">max_within_feasible</span></code> just by specifying <code class="docutils literal notranslate"><span class="pre">&quot;dual&quot;</span></code> as the <code class="docutils literal notranslate"><span class="pre">method</span></code> to be used.</p>
<section id="Example-7:-Device-independent-entanglement-certification">
<h3>Example 7: Device independent entanglement certification<a class="headerlink" href="#Example-7:-Device-independent-entanglement-certification" title="Permalink to this heading"></a></h3>
<p>In this example we are going to combine a few of the tools we have seen so far. On one hand, we will use <code class="docutils literal notranslate"><span class="pre">InflationSDP.set_values</span></code> to fix only certain values of our moment matrix. On the other, we will not specify a DAG but set all sources to be classical when defining <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code> in order to characterize relaxations of the set of distributions that can be generated when the parties have access to global shared randomness. Moreover, we will use certificate information to reduce the number
of evaluations. The goal will be to reproduce the results of [<a class="reference external" href="https://arxiv.org/abs/1612.08551">2</a>] regarding efficient device-independent certifications of entanglement in many-body systems. Concretely, we will compute the noise robustness of the W state of 7 qubits using Inflation. For this, we use tools from the <a class="reference external" href="https://github.com/FlavioBaccari/Hierarchy-for-nonlocality-detection">Hierarchy for nonlocality detection</a> repository. As Example 3, this example also requires the use of the
<a class="reference external" href="https://qutip.org/">QuTiP</a> Python package to simulate measurements on the W state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationSDP</span><span class="p">,</span> <span class="n">InflationProblem</span>
<span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">max_within_feasible</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">expect</span><span class="p">,</span> <span class="n">ket2dm</span><span class="p">,</span> <span class="n">qeye</span><span class="p">,</span> <span class="n">sigmax</span><span class="p">,</span>
                   <span class="n">sigmaz</span><span class="p">,</span> <span class="n">tensor</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c1"># How many spins in the system</span>
<span class="n">outcomes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>  <span class="c1"># 2 measurements per site</span>
<span class="n">settings</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>  <span class="c1"># 2 outcomes per site</span>
<span class="n">bell</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">outcomes_per_party</span><span class="o">=</span><span class="n">outcomes</span><span class="p">,</span>
                        <span class="n">settings_per_party</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                        <span class="n">classical_sources</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">bell</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa2&quot;</span><span class="p">)</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">measurements</span>

<span class="k">def</span> <span class="nf">get_W_reduced</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates the reduced four-body state for the N-partite</span>
<span class="sd">    W state. Since the W state is symmetric, it is independent</span>
<span class="sd">    of the choice of the four parties that one considers.</span>
<span class="sd">    Source:</span>
<span class="sd">    https://github.com/FlavioBaccari/Hierarchy-for-nonlocality-detection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">get_W_state</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates the density matrix for the N-partite W</span>
<span class="sd">        state.&quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
                       <span class="o">+</span> <span class="p">[</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
            <span class="n">components</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">+=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">N</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">state</span>

    <span class="n">w</span> <span class="o">=</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">get_W_state</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">rest</span> <span class="o">=</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]))</span>

    <span class="k">return</span> <span class="mf">4.</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">rest</span>

<span class="n">W_state</span> <span class="o">=</span> <span class="n">get_W_reduced</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">W_operators</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">v</span><span class="o">.</span><span class="n">proj</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">meas</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>
                          <span class="k">for</span> <span class="n">meas</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sigmax</span><span class="p">(),</span> <span class="n">sigmaz</span><span class="p">()]]</span>
                          <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">16</span>

<span class="n">vis</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
<span class="c1"># Creation of the known values. The W state is independent of</span>
<span class="c1"># the choice of the four parties considered. We use this to</span>
<span class="c1"># simplify the calculation of the reduced moments.</span>
<span class="n">known_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">if_p_involved</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)):</span>
    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">if_p_involved</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">known_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">sum</span><span class="p">(</span><span class="n">if_p_involved</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">p_involved</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">if</span> <span class="n">if_p_involved</span><span class="p">[</span><span class="n">p</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">sett</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">settings</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                                 <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_involved</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">outcomes</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
                                  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_involved</span><span class="p">]):</span>
                <span class="n">sdpvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                     <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_involved</span><span class="p">,</span> <span class="n">sett</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
                     <span class="p">])</span>
                <span class="n">projectors</span> <span class="o">=</span> \
                    <span class="p">[</span><span class="n">W_operators</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                     <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_involved</span><span class="p">,</span> <span class="n">sett</span><span class="p">,</span> <span class="n">out</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">if_p_involved</span><span class="p">)):</span>
                    <span class="c1"># Complete with identity projectors</span>
                    <span class="n">projectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">measurement</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">projectors</span><span class="p">)</span>
                <span class="n">known_values</span><span class="p">[</span><span class="n">sdpvar</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="p">(</span><span class="n">vis</span> <span class="o">*</span> <span class="n">expect</span><span class="p">(</span><span class="n">measurement</span><span class="p">,</span> <span class="n">W_state</span><span class="p">)</span>
                     <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vis</span><span class="p">)</span> <span class="o">*</span> <span class="n">expect</span><span class="p">(</span><span class="n">measurement</span><span class="p">,</span> <span class="n">noise</span><span class="p">))</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">known_values</span><span class="p">)</span>

<span class="n">max_within_feasible</span><span class="p">(</span><span class="n">sdp</span><span class="p">,</span> <span class="n">sdp</span><span class="o">.</span><span class="n">known_moments</span><span class="p">,</span> <span class="s2">&quot;dual&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7233583754329858
</pre></div></div>
</div>
<p>We correctly recover the results for the W state visibility of <span class="math notranslate nohighlight">\(\nu_{\textrm{crit}}\approx 0.723\)</span> for <span class="math notranslate nohighlight">\(N=7\)</span> in [<a class="reference external" href="https://arxiv.org/abs/1612.08551">2</a>, Table 1]. Reaching this value took <span class="math notranslate nohighlight">\(5\)</span> iterations of the algorithm (you can check it by passing the argument <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>). In contrast, finding the same value using bisection would have cost solving <span class="math notranslate nohighlight">\(16\)</span> SDPs.</p>
</section>
</section>
<section id="Non-negative-operators-as-generating-monomials">
<h2>Non-negative operators as generating monomials<a class="headerlink" href="#Non-negative-operators-as-generating-monomials" title="Permalink to this heading"></a></h2>
<p>For the generation of the semidefinite programming relaxation, besides NPA levels and local levels, <code class="docutils literal notranslate"><span class="pre">InflationSDP.build_columns</span></code> also accepts as input strings of the form <code class="docutils literal notranslate"><span class="pre">'physicalN'</span></code>. When this is done, the set of monomials used for creating the moment matrix is the subset of local level <span class="math notranslate nohighlight">\(N\)</span> formed by all the monomials which have non-negative expectation value under any quantum state. Using these monomials as generators of the moment matrix is beneficial because the condition that
the moment matrix is positive-semidefinite readily implies that the corresponding expectation values represent probabilities with appropriate normalization constraints. In general, and as we will see below, this turns out to provide tighter characterizations with notably fewer computational resources.</p>
<section id="Example-8:-Critical-visibility-of-the-W-distribution-with-the-hierarchy-of-non-negative-monomials">
<h3>Example 8: Critical visibility of the W distribution with the hierarchy of non-negative monomials<a class="headerlink" href="#Example-8:-Critical-visibility-of-the-W-distribution-with-the-hierarchy-of-non-negative-monomials" title="Permalink to this heading"></a></h3>
<p>As an application, we show how we can recover the critical visibility <span class="math notranslate nohighlight">\(v_{\text{crit}}\approx 0.8038\)</span> of the W distribution, defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}P_W(a,b,c)=\begin{cases} 1 &amp; \text{if } a+b+c=1\\0 &amp; \text{otherwise}\end{cases},\end{split}\]</div>
<p>in the quantum triangle scenario. In [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">6</a>] this result was obtained using the second-order quantum inflation of the triangle scenario, and the generating set corresponding to the monomials of local level 2 which had a maximum of 4 operators. This corresponds to a set of <span class="math notranslate nohighlight">\(1175\)</span> operators, and thus a moment matrix of size <span class="math notranslate nohighlight">\(1175\times 1175\)</span>. We now shall see that we can obtain the same result using only the generating monomials which are
non-negative:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">max_within_feasible</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span>
               <span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_AC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
               <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
               <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="n">nonneg</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;physical2&quot;</span><span class="p">,</span> <span class="n">max_monomial_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of operators:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nonneg</span><span class="p">))</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="n">nonneg</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P_W</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="k">return</span> <span class="n">vis</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vis</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P_W</span><span class="p">(</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)))</span>
<span class="n">max_within_feasible</span><span class="p">(</span><span class="n">sdp</span><span class="p">,</span> <span class="n">sdp</span><span class="o">.</span><span class="n">known_moments</span><span class="p">,</span> <span class="s2">&quot;dual&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of operators: 287
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8038476176808751
</pre></div></div>
</div>
<p>We recover the same critical visibility of <span class="math notranslate nohighlight">\(v_{\text{crit}}\approx 0.8039\)</span> with a moment matrix of size <span class="math notranslate nohighlight">\(287\times 287\)</span> as opposed to <span class="math notranslate nohighlight">\(1175\times 1175\)</span>, which leads to a significant gain in performance.</p>
</section>
</section>
<section id="Linearized-polynomial-identification-constraints">
<h2>Linearized polynomial identification constraints<a class="headerlink" href="#Linearized-polynomial-identification-constraints" title="Permalink to this heading"></a></h2>
<p>In order to increase the tightness of the relaxations, one can impose in the programs the so-called linearized polynomial identification (LPI) constraints [<a class="reference external" href="https://arxiv.org/abs/2203.16543">9</a>]. These are proportionality constraints between different variables in the program (inflation probabilities in case of linear programs and entries in the moment matrix in semidefinite programs), which arise due to the fact that there exist disconnected sets of parties in the inflation graphs.</p>
<p>As a simplified example, consider the moment <span class="math notranslate nohighlight">\(\langle A^{110}_{xa} B^{202}_{x'a'} B^{201}_{yb} \rangle\)</span> in a quantum inflation of the triangle scenario, where the superindices indicate the copies of the sources that arrive to each party, and the value 0 means that the party does not measure the corresponding source. For example, <span class="math notranslate nohighlight">\(B^{201}_{yb}\)</span> represents Bob measuring outcome <span class="math notranslate nohighlight">\(b\)</span> of setting <span class="math notranslate nohighlight">\(y\)</span> on copy 2 of <span class="math notranslate nohighlight">\(\rho_{AB}\)</span> and copy 1 of <span class="math notranslate nohighlight">\(\rho_{BC}\)</span>. Notice that
because of the non-overlapping support of some of the moments, the moment factorises as follows:</p>
<div class="math notranslate nohighlight">
\[\langle A^{110}_{xa} B^{202}_{x'a'} B^{201}_{yb} \rangle = \langle A^{110}_{xa} \rangle \langle B^{202}_{x'a'} B^{201}_{yb} \rangle\]</div>
<p>The moment <span class="math notranslate nohighlight">\(\langle A^{110}_{xa} \rangle\)</span> is known to be equal to <span class="math notranslate nohighlight">\(p_A(a|x)\)</span>, but <span class="math notranslate nohighlight">\(\langle B^{202}_{x'a'} B^{201}_{yb} \rangle\)</span> is unknown. Therefore, in compatibility problems where <span class="math notranslate nohighlight">\(p_A(a|x)\)</span> is associated a number, a linear proportionality relationship between the variables <span class="math notranslate nohighlight">\(\langle A^{110}_{xa} B^{202}_{x'a'} B^{201}_{yb} \rangle\)</span> and <span class="math notranslate nohighlight">\(\langle B^{202}_{x'a'} B^{201}_{yb} \rangle\)</span> can be imposed, the proportionality constant being <span class="math notranslate nohighlight">\(p_A(a|x)\)</span>.</p>
<p>Proportionality constraints of these form can be automatically implemented by setting <code class="docutils literal notranslate"><span class="pre">use_lpi_constraints</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> when using <code class="docutils literal notranslate"><span class="pre">Inflation(L/SD)P.set_values</span></code> or <code class="docutils literal notranslate"><span class="pre">Inflation(L/SD)P.set_distribution</span></code>.</p>
<section id="Example-9:-Critical-visibility-of-the-W-distribution-with-LPI-constraints">
<h3>Example 9: Critical visibility of the W distribution with LPI constraints<a class="headerlink" href="#Example-9:-Critical-visibility-of-the-W-distribution-with-LPI-constraints" title="Permalink to this heading"></a></h3>
<p>We will now show how using LPI constraints lead to tighter relaxations. Let us revisit Example 7 and insert the new constraints:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">max_within_feasible</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span>
               <span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rho_AB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_BC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;rho_AC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]},</span>
               <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
               <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">build_columns</span><span class="p">(</span><span class="s2">&quot;physical2&quot;</span><span class="p">,</span> <span class="n">max_monomial_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P_W</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="k">return</span> <span class="n">vis</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vis</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P_W</span><span class="p">(</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)))</span>
<span class="n">moments</span> <span class="o">=</span> <span class="n">sdp</span><span class="o">.</span><span class="n">known_moments</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="n">max_within_feasible</span><span class="p">(</span><span class="n">sdp</span><span class="p">,</span> <span class="n">moments</span><span class="p">,</span> <span class="s2">&quot;dual&quot;</span><span class="p">,</span>
                    <span class="n">use_lpi_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7563883306017936
</pre></div></div>
</div>
<p>The critical value for the noise that we achieve, <span class="math notranslate nohighlight">\(v_{\text{crit}}=0.7624\)</span>, is lower than the critical value for the noise that we achieved in Example 7, <span class="math notranslate nohighlight">\(v_{\text{crit}}=0.8039\)</span>.</p>
<p><strong>Warning!</strong> The tradeoff of using LPI constraints is that the dual certificate is no longer valid for other distributions. We can still certify incompatibility of a specific distribution <span class="math notranslate nohighlight">\(P_0\)</span> with a certain causal model with the extracted certificate <span class="math notranslate nohighlight">\(\text{Poly}_{P_0}(P_0)&gt;0\)</span> when using LPI constraints, but when checking other distributions <span class="math notranslate nohighlight">\(P_1\)</span> with the same certificate, satisfying the inequality <span class="math notranslate nohighlight">\(\text{Poly}_{P_0}(P_1)&gt;0\)</span> no longer guarantees that <span class="math notranslate nohighlight">\(P_1\)</span> is
also incompatible with the same causal structure. For a more detailed discussion, see [<a class="reference external" href="https://www.arxiv.org/abs/2203.16543">9</a>].</p>
</section>
</section>
<section id="Non-network-scenarios">
<h2>Non-network scenarios<a class="headerlink" href="#Non-network-scenarios" title="Permalink to this heading"></a></h2>
<p>So far all examples have dealt with network-type DAGs. These are bipartite DAGs where one layer of visible nodes (representing settings) and latent nodes (representing sources) are parents to children in another layer of visible nodes that represent the parties’ outcomes. The tripartite-line DAG in Examples 1 and 3 and the triangle DAG in Examples 2 and 4 are both illustration of network-type DAGs. One could consider more complicated scenarios, like a DAG where the outcome of a party is sent as
input to the measurement performed by another party. For such situations, it is possible to find a network DAG such that restrictions of the distributions compatible with it characterize the distributions compatible with the non-network DAG [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">6</a>]. Inflation can easily handle these scenarios in the same workflow as for network scenarios.</p>
<section id="Example-10:-Feasibility-and-optimization-in-the-instrumental-scenario">
<h3>Example 10: Feasibility and optimization in the instrumental scenario<a class="headerlink" href="#Example-10:-Feasibility-and-optimization-in-the-instrumental-scenario" title="Permalink to this heading"></a></h3>
<p>The simplest causal scenario that exhibits a gap between classical, quantum and post-quantum correlations is the instrumental scenario [<a class="reference external" href="https://arxiv.org/abs/1804.04119">10</a>]. The instrumental scenario features two parties, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, that share a common source of correlations. While party <span class="math notranslate nohighlight">\(A\)</span> can choose between different measurement settings, <span class="math notranslate nohighlight">\(x\)</span>, party <span class="math notranslate nohighlight">\(B\)</span> has no input choice. However, party <span class="math notranslate nohighlight">\(A\)</span> is allowed to signal their output to party <span class="math notranslate nohighlight">\(B\)</span>. The
scenario is depicted as a DAG in Figure a) below. The associated network DAG is depicted in Figure b). The set of distributions <span class="math notranslate nohighlight">\(p(a,b|x)\)</span> compatible with the non-network DAG of Figure a) is equivalent to the set of distributions <span class="math notranslate nohighlight">\(p(a,b|x,y{=}a)\)</span> compatible with the network DAG of Figure b).</p>
<center><table><tr><td><center><p><img alt="instrumental" class="no-scaled-link" src="_images/instrumental.png" style="width: 250px;" /></p>
<figcaption><ol class="loweralpha">
<li><p>The instrumental scenario.</p>
</figcaption></center></td><td><div class="horizontalgap" style="width:50px"></div></td><td><center><p><img alt="instrumental interrupted" class="no-scaled-link" src="_images/instrumentalinterrupted.png" style="width: 250px;" /></p>
<figcaption><ol class="loweralpha" start="2">
<li><p>The corresponding network.</p>
</figcaption></center></td></tr></table></center></li>
</ol>
</li>
</ol>
<p>Inflation, upon inputting Figure a) as the DAG to an <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code>, automatically transforms the scenario into that of Figure b) and adapts the setting of values and bounds to only process those pertinent to the original scenario, letting the rest free. In the network scenario, the input cardinality of children increases to accommodate the different output values of the parent nodes. For the instrumental scenario, this means that if party <span class="math notranslate nohighlight">\(B\)</span> had an input <span class="math notranslate nohighlight">\(y\)</span> in the
instrumental scenario, in the equivalent network it would have an input <span class="math notranslate nohighlight">\(y'=(y,a)\)</span>. The attribute <code class="docutils literal notranslate"><span class="pre">InflationProblem.effective_to_parent_settings</span></code> stores the mapping between the effective settings in the network equivalent scenario and the actual setting and the other parties’ outcomes that are used as input in the non-network scenario.</p>
<p>As illustrations, let us calculate the critical visibility for the following distribution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(a,b|x)= \begin{cases}1 / 2 &amp; \text { if } b=a+f(x, a) \quad \bmod 2 \\ 0 &amp; \text { otherwise }\end{cases},\quad f(x, a)=\begin{cases} 0 &amp; x=0 \\ a &amp; x = 1 \\ a + 1 \bmod2 &amp; x=2 \end{cases}\end{split}\]</div>
<p>in the quantum instrumental scenario, and calculating classical and quantum bounds for Bonet’s operator:</p>
<div class="math notranslate nohighlight">
\[\begin{split}I_{\text {Bonet }}:=p(a{=}b\vert 0)+p(b{=}0\vert 1)+p(a{=}0, b{=}1\vert 2) \leq \begin{cases}2 &amp; \text { Classical } \\ (3+\sqrt{2}) / 2 &amp; \text { Quantum }\end{cases}\end{split}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">max_within_feasible</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span> <span class="k">as</span> <span class="n">Sym</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rhoAB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                             <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]},</span>
                        <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="n">vis</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">vis</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vis</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)))</span>
<span class="n">v_crit</span> <span class="o">=</span> <span class="n">max_within_feasible</span><span class="p">(</span><span class="n">sdp</span><span class="p">,</span> <span class="n">sdp</span><span class="o">.</span><span class="n">known_moments</span><span class="p">,</span> <span class="s2">&quot;dual&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical visibility:&quot;</span><span class="p">,</span> <span class="n">v_crit</span><span class="p">)</span>

<span class="n">objective</span> <span class="o">=</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pAB(00|00)&quot;</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">+=</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pA(1|0)&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pAB(10|00)&quot;</span><span class="p">)</span>    <span class="c1"># p(11|0)</span>
<span class="n">objective</span> <span class="o">+=</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pAB(00|10)&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pAB(10|10)&quot;</span><span class="p">)</span> <span class="c1"># pB(0|1)</span>
<span class="n">objective</span> <span class="o">+=</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pA(0|2)&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;pAB(00|20)&quot;</span><span class="p">)</span>    <span class="c1"># p(01|2)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bonet Bell operator ≤ </span><span class="si">{</span><span class="n">sdp</span><span class="o">.</span><span class="n">objective_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> &quot;</span>
      <span class="o">+</span> <span class="s2">&quot;(Quantum)&quot;</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rhoAB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                             <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]},</span>
                        <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">classical_sources</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rhoAB&quot;</span><span class="p">])</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bonet Bell operator ≤ </span><span class="si">{</span><span class="n">sdp</span><span class="o">.</span><span class="n">objective_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> &quot;</span>
      <span class="o">+</span> <span class="s2">&quot;(Classical)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Critical visibility: 0.716430716116071
Bonet Bell operator ≤ 2.2071 (Quantum)
Bonet Bell operator ≤ 2.0000 (Classical)
</pre></div></div>
</div>
<p>Note that we have had to write <span class="math notranslate nohighlight">\(p(a, b{=}1\vert x) = p(a \vert x) - p(a, b{=}0\vert x)\)</span> explicitly. This is due to the fact that, internally, Inflation works with Collins-Gisin notation [<a class="reference external" href="https://arxiv.org/abs/quant-ph/0306129">11</a>], and therefore some probability elements must be written in terms of the available ones. This is no different to the processing that we had to do in Example 4.</p>
</section>
<section id="Example-11:-Scenarios-with-multiple-layers-of-latent-nodes">
<h3>Example 11: Scenarios with multiple layers of latent nodes<a class="headerlink" href="#Example-11:-Scenarios-with-multiple-layers-of-latent-nodes" title="Permalink to this heading"></a></h3>
<p>The instrumental scenario has a visible node (node <span class="math notranslate nohighlight">\(A\)</span>) with both parents and children. Internally, <code class="docutils literal notranslate"><span class="pre">inflation</span></code> handles these scenarios by adding an effective input to the children, and considering only the probabilities where the value of the node and the value of the effective input coincide. The remaining case is that of latent variables with both parents and children. These can be understood as joint operations on the incoming systems, which are later distributed forwards in the
scenario. It is possible to characterize these scenarios in <code class="docutils literal notranslate"><span class="pre">inflation</span></code> by specifying <code class="docutils literal notranslate"><span class="pre">classical_intermediate_latents</span></code> and <code class="docutils literal notranslate"><span class="pre">nonclassical_intermediate_latents</span></code> in the <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code> constructor.</p>
<p>As an example, let us recover some results of [<a class="reference external" href="https://www.arxiv.org/abs/2403.02376">12</a>], regarding distributions that are generated in complex scenarios with multiple layers of latent nodes but cannot be generated in networks with only one layer of latent nodes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Distribution: noisy GHZ distribution for visibility 1/2</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">27</span><span class="o">/</span><span class="mi">128</span>
<span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> \
<span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> \
<span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span><span class="o">/</span><span class="mi">128</span>
<span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> \
<span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> \
<span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">128</span>
<span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">128</span>

<span class="c1"># Non-network scenario. See Fig. 1b-ii of [12]</span>
<span class="n">nonnetwork</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;S1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;F1&quot;</span><span class="p">],</span>
                                   <span class="s2">&quot;S2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;F1&quot;</span><span class="p">,</span> <span class="s2">&quot;F2&quot;</span><span class="p">],</span>
                                   <span class="s2">&quot;S3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;F2&quot;</span><span class="p">,</span> <span class="s2">&quot;A6&quot;</span><span class="p">],</span>
                                   <span class="s2">&quot;F1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">],</span>
                                   <span class="s2">&quot;F2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="s2">&quot;A5&quot;</span><span class="p">]</span>
                                   <span class="p">},</span>
                              <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="s2">&quot;A5&quot;</span><span class="p">,</span> <span class="s2">&quot;A6&quot;</span><span class="p">),</span>
                              <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                              <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                              <span class="n">nonclassical_intermediate_latents</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;F1&quot;</span><span class="p">,</span> <span class="s2">&quot;F2&quot;</span><span class="p">),</span>
                              <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                              <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">nonnetwork</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa1&quot;</span><span class="p">)</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating the distribution in the multi-latent-layer network is &quot;</span>
      <span class="o">+</span> <span class="n">sdp</span><span class="o">.</span><span class="n">status</span> <span class="o">+</span> <span class="s2">&quot; (a priori)&quot;</span><span class="p">)</span>

<span class="c1"># Network scenario. See Fig. 1b-iii of [12]</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;S1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">],</span>
                                <span class="s2">&quot;S2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="s2">&quot;A5&quot;</span><span class="p">],</span>
                                <span class="s2">&quot;S3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="s2">&quot;A5&quot;</span><span class="p">,</span> <span class="s2">&quot;A6&quot;</span><span class="p">]</span>
                                <span class="p">},</span>
                           <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="s2">&quot;A5&quot;</span><span class="p">,</span> <span class="s2">&quot;A6&quot;</span><span class="p">),</span>
                           <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                           <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                           <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                           <span class="p">)</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;npa1&quot;</span><span class="p">)</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating the distribution in the single-latent-layer network is &quot;</span>
      <span class="o">+</span> <span class="n">sdp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generating the distribution in the multi-latent-layer network is feasible (a priori)
Generating the distribution in the single-latent-layer network is infeasible
</pre></div></div>
</div>
</section>
</section>
<section id="Feasibility-based-on-distribution-supports">
<h2>Feasibility based on distribution supports<a class="headerlink" href="#Feasibility-based-on-distribution-supports" title="Permalink to this heading"></a></h2>
<p>There is a lot of literature regarding the violation of Bell-type inequalities as certification of non-classical behavior. These inequalities put constraints on combinations of probability elements. There exist even simpler certifications of non-classicality, that instead rely on possibilistic arguments: they only assume whether certain events are possible (positive probability) or impossible (zero probability) in order to reach a contradiction. These are known as Hardy-type paradoxes
[<a class="reference external" href="https://arxiv.org/abs/1105.1819">13</a>].</p>
<p>Inflation can handle proofs of non-classicality and non-quantumness in arbitrary DAGs based on possibilistic arguments. It does so by assessing whether a quantum inflation (with commuting or non-commuting operators, respectively) exists where the probability elements inside the support are constrained to lie in the interval <span class="math notranslate nohighlight">\([1,\infty)\)</span> while those outside the support are given the value <span class="math notranslate nohighlight">\(0\)</span>. This represents a rescaled version of a standard quantum inflation moment matrix,
<span class="math notranslate nohighlight">\(\Gamma^*=\Gamma/\epsilon\)</span>, that does not suffer of floating-point instabilities when determining if a probability element is outside the support or has assigned a very small value. To get back the original moment matrix <span class="math notranslate nohighlight">\(\Gamma\)</span>, which contains probabilities as some of its cells, one just needs to divide <span class="math notranslate nohighlight">\(\Gamma^*\)</span> by the numerical value in its top-left corner, which corresponds to the rescaled value of the expectation value for the identity,
<span class="math notranslate nohighlight">\(\langle 1 \rangle^*=1/\epsilon\)</span>.</p>
<p>In order to deal with possibilistic feasibility problems, one must set the argument <code class="docutils literal notranslate"><span class="pre">supports_problem=True</span></code> when instantiating <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code>. Optimization of objective functions is not possible when assessing the feasibility of distribution supports.</p>
<section id="Example-12:-Impossible-distributions-in-the-quantum-instrumental-scenario">
<h3>Example 12: Impossible distributions in the quantum instrumental scenario<a class="headerlink" href="#Example-12:-Impossible-distributions-in-the-quantum-instrumental-scenario" title="Permalink to this heading"></a></h3>
<p>As an example, let us show that no distribution that has the same support as the distribution from Example 9 can be generated in the quantum instrumental scenario:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rhoAB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                             <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]},</span>
                        <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">supports_problem</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="n">noise</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">noise</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">noise</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">status</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;infeasible&#39;
</pre></div></div>
</div>
<p>In fact, it is possible to do a finer specification. Namely, one can specify events that are impossible, definitely within the support of possible events, and unknown whether they eventually happen at some point or not. The first two are fixed by the same procedure as above (feeding in a distribution that has zero probability for the events definitely outside the support and nonzero probability for the events definitely inside the support). In order to account for events that may or may not be
inside the support, we set their corresponding values to <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>. We can use this to recover Hardy’s paradox.</p>
</section>
<section id="Example-13:-Hardy’s-paradox">
<h3>Example 13: Hardy’s paradox<a class="headerlink" href="#Example-13:-Hardy’s-paradox" title="Permalink to this heading"></a></h3>
<p>We will now show a quantum Hardy-type paradox, i.e., we will see that certain constraints on the support of distributions cannot all be achieved in quantum mechanics. The example below is taken from [<a class="reference external" href="https://arxiv.org/abs/1006.2497">14</a>].</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rhoAB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]},</span>
                        <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">settings_per_party</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">sdp</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">supports_problem</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="s2">&quot;local1&quot;</span><span class="p">)</span>

<span class="n">sdp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">sdp</span><span class="o">.</span><span class="n">status</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;infeasible&#39;
</pre></div></div>
</div>
<p>The result above means that no probability distribution whose support contains <span class="math notranslate nohighlight">\(p(1,1|1,1)\)</span> and does not contain neither <span class="math notranslate nohighlight">\(p(0,0|0,0)\)</span>, <span class="math notranslate nohighlight">\(p(1,1|0,0)\)</span>, <span class="math notranslate nohighlight">\(p(1,1|1,0)\)</span> nor <span class="math notranslate nohighlight">\(p(1,1|0,1)\)</span> can be realized in quantum mechanics. By removing any one of the first four conditions, the problem becomes feasible.</p>
</section>
</section>
<section id="Estimation-of-causal-strengths">
<h2>Estimation of causal strengths<a class="headerlink" href="#Estimation-of-causal-strengths" title="Permalink to this heading"></a></h2>
<p>Interventions are a fundamental tool for causal analysis, since they allow to separate correlation from causation. In order to detect the direction of a causal arrow between two correlated variables, one can fix (intervene) one of the variables and see how the distribution of the other variable changes. Also, the strength of a causal direction can be quantified by the amount of change in the distribution of the children of the intervened variable. These properties can be analyzed in
<code class="docutils literal notranslate"><span class="pre">inflation</span></code> by specifying the relevant causal diagrams and objective functions.</p>
<section id="Example-14:-Estimation-of-the-average-causal-strength-in-the-triangle-scenario-with-signaling">
<h3>Example 14: Estimation of the average causal strength in the triangle scenario with signaling<a class="headerlink" href="#Example-14:-Estimation-of-the-average-causal-strength-in-the-triangle-scenario-with-signaling" title="Permalink to this heading"></a></h3>
<p>As an example, let us analyze the average causal strength of a direct communication from party <span class="math notranslate nohighlight">\(A\)</span> to party <span class="math notranslate nohighlight">\(B\)</span> in the triangle scenario when reproducing the distribution corresponding to a shared random bit. While it is known that the distribution corresponding to a perfect shared random bit cannot be generated in the triangle scenario even with post-quantum resources [<a class="reference external" href="https://www.arxiv.org/abs/1609.00672">3</a>], it is possible to generate it when one of the parties communicates
another one her result. Thus, it becomes interesting to know what is the strength of the new causal arrow that is needed to realize the distribution. This can be estimated as the difference between the probabilities of the child party (say <span class="math notranslate nohighlight">\(B\)</span>) to output <span class="math notranslate nohighlight">\(0\)</span> when the parent party (say <span class="math notranslate nohighlight">\(A\)</span>) outputs <span class="math notranslate nohighlight">\(0\)</span> and when <span class="math notranslate nohighlight">\(A\)</span> outputs <span class="math notranslate nohighlight">\(1\)</span>. This is the average causal strength of the direct communication from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(B\)</span>. Let us calculate this value when the
sources in the triangle scenario are allowed to distribute physical systems only constrained by the no-signaling principle:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationLP</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Shared random bit distribution, or Greenberger-Horne-Zeilinger distribution</span>
<span class="n">P_GHZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">P_GHZ</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">P_GHZ</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Objective to minimize: p(b=0|do(a=0)) - p(b=0|do(a=1))</span>
<span class="n">objective</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;P[B=0|do(A=0)]&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;P[B=0|do(A=1)]&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>

<span class="n">ip</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">({</span><span class="s2">&quot;h1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
                       <span class="s2">&quot;h2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                       <span class="s2">&quot;h3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span>
                       <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]},</span>               <span class="c1"># Direct communication A -&gt; B</span>
                       <span class="n">classical_sources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="c1"># No-signaling sources</span>
                       <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                       <span class="n">settings_per_party</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                       <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                       <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="n">lp</span> <span class="o">=</span> <span class="n">InflationLP</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
<span class="n">lp</span><span class="o">.</span><span class="n">set_distribution</span><span class="p">(</span><span class="n">P_GHZ</span><span class="p">,</span> <span class="n">use_lpi_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lp</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="n">lp</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Causal Effect A-&gt;B: </span><span class="si">{</span><span class="n">lp</span><span class="o">.</span><span class="n">objective_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average Causal Effect A-&gt;B: 1.000
</pre></div></div>
</div>
<p>In [<a class="reference external" href="https://www.arxiv.org/abs/1909.10519">6</a>] the same value is obtained for the case of quantum sources (which, in the code above, can be obtained by using an <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code> object instead of <code class="docutils literal notranslate"><span class="pre">InflationLP</span></code>). This means that having access to post-quantum physical systems does not help in creating the distribution corresponding to a shared random bit in the triangle scenario.</p>
</section>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this heading"></a></h2>
<p>[1] C. Branciard, D. Rosset, N. Gisin, and S. Pironio, <em>Bilocal versus non-bilocal correlations in entanglement swapping experiments</em>, <a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.85.032119">Phys. Rev. A 85, 032119 (2012)</a>, <a class="reference external" href="https://arxiv.org/abs/1112.4502">arXiv:1112.4502</a>.</p>
<p>[2] F. Baccari, D. Cavalcanti, P. Wittek, and A. Acín, <em>Efficient device-independent entanglement detection for multipartite dystems</em>, <a class="reference external" href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.7.021042">Phys. Rev. X 7, 021042 (2017)</a>, <a class="reference external" href="https://arxiv.org/abs/1612.08551">arXiv:1612.08551</a>.</p>
<p>[3] E. Wolfe, R. W. Spekkens, and T. Fritz, <em>The inflation technique for causal inference with latent variables</em>, <a class="reference external" href="https://www.degruyter.com/document/doi/10.1515/jci-2017-0020/html">J. Causal Inference 7, 2017-0020 (2019)</a>, <a class="reference external" href="https://arxiv.org/abs/1609.00672">arXiv:1609.00672</a>.</p>
<p>[4] T. Fritz, <em>Beyond Bell’s theorem: Correlation scenarios</em>, <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1367-2630/14/10/103001">New J. Phys. 14 103001 (2012)</a>, <a class="reference external" href="https://www.arxiv.org/abs/1206.5115">arXiv:1206.5115</a>.</p>
<p>[5] A. Pozas-Kerstjens, N. Gisin, and A. Tavakoli, <em>Full network nonlocality</em>, <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.128.010403">Phys. Rev. Lett. 128, 010403 (2022)</a>, <a class="reference external" href="https://arxiv.org/abs/2105.09325">arXiv:2105.09325</a>.</p>
<p>[6] E. Wolfe, A. Pozas-Kerstjens, M. Grinberg, D. Rosset, A. Acín, and Miguel Navascués, <em>Quantum inflation: A general approach to quantum causal compatibility</em>, <a class="reference external" href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.11.021043">Phys. Rev. X 11, 021043 (2021)</a>, <a class="reference external" href="https://www.arxiv.org/abs/1909.10519">arXiv:1909.10519</a>.</p>
<p>[7] M. Navascués, S. Pironio, and A. Acín, <em>A convergent hierarchy of semidefinite programs characterizing the set of quantum correlations</em>, <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1367-2630/10/7/073013">New J. Phys. 10, 073013</a>, <a class="reference external" href="https://arxiv.org/abs/0803.4290">arXiv:0803.4290</a>.</p>
<p>[8] S. Popescu and D. Rohrlich, <em>Quantum nonlocality as an axiom</em>, <a class="reference external" href="https://link.springer.com/article/10.1007/BF02058098">Found. Phys. 24, 379–385 (1994)</a>, <a class="reference external" href="https://arxiv.org/abs/quant-ph/9508009">arXiv:quant-ph/9508009</a>.</p>
<p>[9] A. Pozas-Kerstjens, N. Gisin, and M.-O. Renou, <em>Proofs of network quantum nonlocality in continuous families of distributions</em>, <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.130.090201">Phys. Rev. Lett. 130, 090201 (2023)</a>, <a class="reference external" href="https://arxiv.org/abs/2203.16543">arXiv:2203.16543</a>.</p>
<p>[10] T. van Himbeeck, J. Bohr Brask, S. Pironio, R. Ramanathan, A. Belén Sainz, and E. Wolfe, <em>Quantum violations in the Instrumental scenario and their relations to the Bell scenario</em>, <a class="reference external" href="https://quantum-journal.org/papers/q-2019-09-16-186/">Quantum 3, 186 (2019)</a>, <a class="reference external" href="https://arxiv.org/abs/1804.04119">arXiv:1804.04119</a>.</p>
<p>[11] D. Collins and N. Gisin, <em>A relevant two qubit Bell inequality inequivalent to the CHSH inequality</em>, <a class="reference external" href="https://iopscience.iop.org/article/10.1088/0305-4470/37/5/021">J. Phys. A: Math. Gen. 37, 1775 (2004)</a>, <a class="reference external" href="https://arxiv.org/abs/quant-ph/0306129">arXiv:quant-ph/0306129</a>.</p>
<p>[12] A. Ulibarrena, J. W. Webb, A. Pickston, J. Ho, A. Fedrizzi, and A. Pozas-Kerstjens, <em>Guarantees on the structure of experimental quantum networks</em>, <a class="reference external" href="https://www.nature.com/articles/s41534-024-00911-z">npj Quantum Inf. 10, 117 (2024)</a>, <a class="reference external" href="https://arxiv.org/abs/2403.02376">arXiv:2403.02376</a>.</p>
<p>[13] S. Mansfield and T. Fritz, <em>Hardy’s non-locality paradox and possibilistic conditions for non-locality</em>, <a class="reference external" href="https://link.springer.com/article/10.1007/s10701-012-9640-1">Found. Phys. 42, 709–719 (2012)</a>, <a class="reference external" href="https://arxiv.org/abs/1105.1819">arXiv:1105.1819</a>.</p>
<p>[14] T. Fritz, <em>Quantum analogues of Hardy’s nonlocality paradox</em>, <a class="reference external" href="https://link.springer.com/article/10.1007/s10701-011-9563-2">Found. Phys. 41, 1493-1501 (2011)</a>, <a class="reference external" href="https://arxiv.org/abs/1006.2497">arXiv:1006.2497</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">inflation</span><span class="o">,</span> <span class="nn">qutip</span>
<span class="n">inflation</span><span class="o">.</span><span class="n">about</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;QuTiP version: &quot;</span><span class="p">,</span> <span class="n">qutip</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Inflation: Implementations of the Inflation Technique for Causal Inference
==============================================================================
Authored by: Emanuel-Cristian Boghiu, Elie Wolfe and Alejandro Pozas-Kerstjens

Inflation Version:      2.0.2

Core Dependencies
-----------------
NumPy Version:  1.26.4
SciPy Version:  1.11.4
SymPy Version:  1.12
Numba Version:  0.58.1
Mosek Version:  10.1.21

Python Version: 3.10.4
Platform Info:  Windows (AMD64)

QuTiP version:  4.7.4
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="advanced.html" class="btn btn-neutral float-right" title="Advanced" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Emanuel-Cristian Boghiu, Elie Wolfe, Alejandro Pozas-Kerstjens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>